<html>
<head>
<link type="text/css" rel="stylesheet" href="http://style.fluig.com/css/fluig-style-guide.min.css" />
<script type="text/javascript" src="/portal/resources/js/jquery/jquery.js"></script>
<script type="text/javascript" src="/portal/resources/js/jquery/jquery-ui.min.js"></script>
<script type="text/javascript" src="/portal/resources/js/mustache/mustache.min.js"></script>
<script type="text/javascript" src="/resources/bootstrap/js/utils.js"></script>
<script type="text/javascript" src="http://style.fluig.com/js/fluig-style-guide.min.js" charset="utf-8"></script>
</head>
<body>
	<div class="fluig-style-guide">
		<form name="form" role="form">
			<div class="row">
				<div class="col-xs-3">
					<div class="form-group">
						<label for="meeting">QQ coisa</label>
						<input class="form-control" name="meeting" id="meeting" type="text" maxlength="200" />						
					</div>
				</div>
			</div>
			<div class="row">
				<div id="divAtividades">
					<div class="form-field table-responsive" data-type="tabledetail" data-show-properties="" data-field-name="tabledetail">
						<table tablename="tbatividades" cellspacing="0" id="tbatividades" noaddbutton=true class="table" customFnDelete="removeTarefa(this)">
							<thead>
								<tr class="tableHeadRow">
									<th class="tableColumn">Atividade</th>
									<th class="tableColumn">data</th>
									<th class="tableColumn">Responsavel</th>
									<th class="tableColumn">Processo</th>
									<th class="tableColumn">Status</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td class="col-xs-3">
										<div class="form-group">
											<textarea name="descAtividade" class="form-control" rows="3" ></textarea>
										</div>
									</td>
									<td class="col-xs-2">
										<div class="form-group fs-cursor-pointer" id="dtprazoativ">
											<div class="input-group date">
												<input type="text" name="dtprazoativ" id="dtprazoativ" class="form-control"  readonly="readonly"/>
												<span class="input-group-addon"> <span class="fluigicon fluigicon-calendar"></span>
												</span>
											</div>
										</div>
									</td>
									<td class="col-xs-3">
										<div class="form-group">
											<div class="input-group">
												<input type="text" name="responsavel" id="responsavel" class="form-control"  readonly="readonly"/>
												<input type="hidden" name="matricula" id="matricula" />
												<span class="input-group-btn">
													<button class="btn btn-default form-control" type="button" onclick='zoomColaborador(this);' id="btZoomColab" name="btZoomColab">
														<i class="fluigicon fluigicon-user-search"></i>
													</button>
												</span>
											</div>
										</div>
									</td>
									<td class="col-xs-2">
										<div class="form-group">
											<input type="text" name="processo" id="processo" class="form-control"/>
										</div>
									</td>
									<td class="col-xs-2">
										<div class="form-group">
											<input type="text" name="status" id="status" class="form-control"  readonly="readonly"/>
										</div>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
					<button type="button" class="btn btn-primary" data-toggle="button" onclick="addTarefa()">addResponsavel</button>
				</div>
			</div>
		</form>
	</div>
</body>
<script type="text/javascript">

	var row;
	
	function zoomColaborador(linha) {
		var nome = $(linha).attr("name");
		row = nome.substring(nome.indexOf("___") + 3, nome.length);
		zoomEcmTipo("colleague",
				"colleagueId,Matricula,colleagueName,Colaborador",
				"colleagueId,colleagueName,extensionNr", "Zoom Colaborador",
				"setColaborador");
		
	}
	
	function setColaborador(selectedItem) {
		$("#matricula___" + row).val(selectedItem['colleagueId']);
		$("#responsavel___" + row).val(selectedItem['colleagueName']);
		
	}
	
	function addTarefa() {
		row = wdkAddChild('tbatividades');
		FLUIGC.calendar("#dtprazoativ___" + row, {
			minDate : new Date(),
		});		
	}
	
	
	function removeTarefa(oElement){		
		var linha = $(oElement).closest('tr');
	    var processo =  linha.find("input").eq(3);
	    if(processo.val() == ""){
	    	fnWdkRemoveChild(oElement);	    	
    	}else{
    		alert("Não é possivel remover tarefas com processos iniciados");	    	  		   		
	    }
	}
	
	
</script>
</html>