<html>
<head>
	<link href="/portal/resources/merged/wcm_global.css" type="text/css" rel="stylesheet">
	<link href="FLUIGADHOC.css" type="text/css" rel="stylesheet" />
	<link href="FLUIGADHOC_form-structure.css" type="text/css" rel="stylesheet" />
	<link href="FLUIGADHOC_form-style.css" type="text/css" rel="stylesheet" />
</head>
<body class="background">
	<form class="form" name="Adhocform" id="Adhocform">
		<input type="hidden" name="qtativ" id="qtativ"/>
		<div class="container" style="display: none">
			<div>
				<div class="grid-7-12 clear">
					<label for="meeting">i18n.translate("adhoc.form.meeting")</label> <input
						name="meeting" id="meeting" type="text" maxlength="200">
				</div>

				<div class="grid-7-12 clear">
					<label>i18n.translate("adhoc.form.detail")</label>
					<textarea name="detail" id="detail" type="textarea" rows="20" maxlength="4000"></textarea>
				</div>

				<div class="grid-3-12 clear">
					<label>i18n.translate("adhoc.form.meetingDate")</label>
					<input name="meetingDate" id="meetingDate" type="text" class="dateHeight">
				</div>

				<div class="grid-3-12">
					<label>i18n.translate("adhoc.form.duedate")</label>
					<input name="dueDate" id="dueDate" type="text" class="dateHeight">
				</div>

				<div class="grid-12-12 clear" style="display:none" id="divAtividades">
					<table border="0" cellpadding="0" tablename="tbatividades" id="tbatividades" class="tbatividades" 
						addbuttonlabel="tbatividades" deleteicon="FLUIGADHOC4.png" width="100%">
						<thead>
							<tr style="text-align: center">
								<td class="nomeativ"><label>i18n.translate("adhoc.form.activity")</label></td>
								<td class="dtprazoativ"><label>i18n.translate("adhoc.form.term")</label></td>
								<td style="width:150px">
									<label>
										i18n.translate("adhoc.form.patrocinador")&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
									</label>								
								</td>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>
									<input type="text" name="nomeativ" class="nomeativ" maxlength="200" />
								</td>
								<td>
									<input type="text" name="dtprazoativ" class="dtprazoativ dateHeight" />
								</td>
								<td>
									<input type="hidden" name="hdnrespativ"	id="hdnrespativ" /> 
									<input type="text" name="txtrespativ" id="txtrespativ" readonly="readonly" class="hdnrespativ" 
									onClick="Javascript:zoomResp(this)" />
								</td>
								<td>
									<a href="#" class="zoomResponsible" data-select-user="" style="" onClick="Javascript:zoomResp(this)"></a>
								</td>

							</tr>
						</tbody>
					</table>
					<br>
					<input type="button" class="addactivity btn totvs-btn-action" id="addActivityButton" value="i18n.translate("adhoc.form.Addactivity")"
						onclick="addTask()"/>
				</div>
				<div class="grid-12-12 clear" style="display:none" id="divMSG">
					i18n.translate("adhoc.form.msg") <a href="#" onclick="parent.ECM.workflowView.tabView.selectTab(1)">i18n.translate("adhoc.form.msgLink")</a>!
				</div>
			</div>
		</div>
	</form>

	<script src="/portal/resources/js/jquery/jquery.js"></script>
	<script src="/portal/resources/js/jquery/jquery-ui.min.js"></script>
	<script src="FLUIGADHOC_formee.js"></script>
	<script src="FLUIGADHOC.js"></script>

	<script>
		var zoomLine;
		var queryParams;
		
		function zoomDataSet(titulo, dataset, campos, resultFields, type) {
			window.open("/webdesk/zoom.jsp?datasetId=" + dataset
							+"&filterValues=active,true&dataFields=" + campos + "&resultFields="
							+ resultFields + "&type=" + type + "&title="
							+ titulo, "zoom",
							"status , scrollbars=no ,width=750, height=500 , top=0 , left=0");
		}

		function zoomResp(obj) {
			if(obj.tagName.toUpperCase()==="A"){
				obj = $(obj.parentElement.parentElement).find("input")[0];
			}
			
			
			zoomLine = obj.id.substring(obj.id.lastIndexOf("_") + 1,
					obj.id.lenght);
			zoomDataSet('Colaborador', 'colleague',
					'colleagueId,Matricula,colleagueName,Nome Colaborador',
					'colleagueName,colleagueId');
		}

		function setSelectedZoomItem(selectedItenom) {
			$("#hdnrespativ___" + zoomLine).val(selectedItenom.colleagueId);
			$("#txtrespativ___" + zoomLine).val(selectedItenom.colleagueName);
		}
		
		function getQueryParams(qs) {
		    qs = qs.split("+").join(" ");

		    var params = {}, tokens,
		        re = /[?&]?([^=]+)=([^&]*)/g;

		    while (tokens = re.exec(qs)) {
		        params[decodeURIComponent(tokens[1])] = decodeURIComponent(tokens[2]);
		    }
		    
		    return params;
		}
		
		function addTask() {
			$('#tbatividades').show();
			wdkAddChild('tbatividades');
			
			$(".dtprazoativ").last().datepicker({
				minDate: 0,
				dateFormat: 'dd/mm/yy'
			});
		}
	</script>
</body>
</html>